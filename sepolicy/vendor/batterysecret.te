type batterysecret, domain;
type batterysecret_exec, exec_type, vendor_file_type, file_type;

allow batterysecret batterysecret:netlink_kobject_uevent_socket { read };
allow batterysecret sysfs:file { read };
allow batterysecret sysfs:file { open };
allow batterysecret sysfs:file { getattr };

allow init batterysecret_exec:file { execute };
allow init batterysecret:process { transition };

allow batterysecret batterysecret_exec:file { entrypoint };

allow init batterysecret:process { rlimitinh };
allow init batterysecret:process { siginh };

allow batterysecret kmsg_device:chr_file { getattr };
allow batterysecret kmsg_device:chr_file { write };
allow batterysecret kmsg_device:chr_file { open };
allow batterysecret batterysecret:netlink_kobject_uevent_socket { create };
allow batterysecret batterysecret:netlink_kobject_uevent_socket { bind };

allow batterysecret sysfs:file { write };

allow init batterysecret:process { noatsecure };
